<HTML>
<HEAD>
<TITLE>Menu Builder</title>
<SCRIPT LANGUAGE="JavaScript1.1">
<!--

init();

function init() {
  // data.html
  ar = new Array();
  for (var i = 0; i < 51; i++) {
    ar[i] = new Array();
    for (var j = 0; j < 50; j++) {
      ar[i][j] = new Website();
    }
    ar[i].inuse = (i == 0) ? 1 : 0;
  }
  tree = 0;

  // appearance.html
  several = 1;
  formIndex = 0;
  sizeP = 1;
  sizePnumber = 0;
  sizeC = 1;
  sizeCnumber = 0;
  button = 0; // 0 - a standard button, 1 - an image, 2 - no button
  label = "Load";
  butSRC = "";
  butWIDTH = "";
  butHEIGHT = "";
  butALT = "";
  twoButtons = 0;

  // loading.html
  live = 0;
  targetWin = 0; // 0 - current window or frame, 1 - a different frame, 2 - parent, 3 - top, 4 - a different window, 5 - a new window
  frameIndex = 0;
  frameName = "";
  windowName = "";
  cgi = 0;
  cgiScript = "/cgi-bin/load.pl";
  same = 0;
}

function Website() {
  this.name = "";
  this.url = "";
}

function formName() {
  return (several == 0) ? "menu" + formIndex : "menu";
}

function load(url) {
  var str = frames[1].location.href;
  if ((str.substring(str.length - 9, str.length) == "data.html") || (str.substring(str.length - 15, str.length) == "appearance.html") || (str.substring(str.length - 12, str.length) == "loading.html"))
    frames[1].finalSave();
  frames[1].location.href = url;
}

function isRelated() {
  for (var i = 1; i < 51; i++) {
    if (ar[i].inuse) return 1;
  }
  return 0;
}

function menuCount(k) {
  for (var i = 0; i < ar[k].length; i++) {
    if (ar[k][i].name == "") break;
  }
  return i;
}

function singleError() {
  var errors = new Array();
  var j = 0;
  if ((button == 2) && (live == 1))
    errors[j++] = 'A non-live menu must have a submission button.<BR>Click <A HREF="javascript:parent.single1()">here</A> to convert it to a live menu.';
  var counter = menuCount(0);
  if ((sizeP == 0) && ((sizePnumber + 2) > counter))
    errors[j++] = 'The size of a scrolling menu should not exceed the total number of items in the menu.<BR>Click <A HREF="javascript:parent.single2()">here</A> to reduce the menu\'s size to the total number of sites in the menu.';
  if ((button == 0) && (label == ""))
    errors[j++] = 'A standard button must have a label.<BR>Click <A HREF="javascript:parent.single3()">here</A> to provide one.';
  if ((button == 1) && (butSRC == ""))
    errors[j++] = 'An image must have a SRC attribute.<BR>Click <A HREF="javascript:parent.single4()">here</A> to provide one.';
  if ((cgi != 2) && (targetWin == 1) && (frameName == ""))
    errors[j++] = 'You did not specify a name for the target frame.<BR>Click <A HREF="javascript:parent.single5()">here</A> to provide one.';
  if ((targetWin == 4) && (windowName == ""))
    errors[j++] = 'You did not specify a name for the target window.<BR>Click <A HREF="javascript:parent.single6()">here</A> to provide one.';
  if ((cgi != 2) && (button != 0))
    errors[j++] = 'Since your form doesn\'t feature a standard "submit" button, it cannot support CGI.<BR>Click <A HREF="javascript:parent.single7()">here</A> to get rid of all CGI references in the code.';
  var isInvalid = invalid(0);
  if ((menuCount(0) == 0) && (!isInvalid))
    errors[j++] = 'You didn\'t enter any menu items.<BR>Click <A HREF="data.html">here</A> to add new sites.';
  if (isInvalid)
    errors[j++] = 'An invalid menu item (a blank Name field) was detected.<BR>Click <A HREF="data.html">here</A> to fix this problem.';
  if (windowName.indexOf(" ") != -1)
    errors[j++] = 'Spaces are not allowed in the target window name.<BR>Click <A HREF="javascript:parent.single6()">here</A> to provide a new name.';
  if (frameName.indexOf(" ") != -1)
    errors[j++] = 'Spaces are not allowed in the target frame name.<BR>Click <A HREF="javascript:parent.single5()">here</A> to provide a new name.';
  return getErrors(errors);
}

function relatedError() {
  var errors = new Array();
  var j = 0;
  if ((button == 2) && (live == 1))
    errors[j++] = 'A non-live menu must have a submission button.<BR>Click <A HREF="javascript:parent.single1()">here</A> to convert it to a live menu.';

  var counter = menuCount(0);
  if ((sizeP == 0) && ((sizePnumber + 2) > counter))
    errors[j++] = 'The size of the parent menu (a scrolling menu) should not exceed the total number of items in it.<BR>Click <A HREF="javascript:parent.single2()">here</A> to reduce the parent menu\'s size to the total number of sites (or topics) in the menu.';

  if ((button == 0) && (label == ""))
    errors[j++] = 'A standard button must have a label.<BR>Click <A HREF="javascript:parent.single3()">here</A> to provide one.';
  if ((button == 1) && (butSRC == ""))
    errors[j++] = 'An image must have a SRC attribute.<BR>Click <A HREF="javascript:parent.single4()">here</A> to provide one.';
  if ((cgi != 2) && (targetWin == 1) && (frameName == ""))
    errors[j++] = 'You did not specify a name for the target frame.<BR>Click <A HREF="javascript:parent.single5()">here</A> to provide one.';
  if ((targetWin == 4) && (windowName == ""))
    errors[j++] = 'You did not specify a name for the target window.<BR>Click <A HREF="javascript:parent.single6()">here</A> to provide one.';
  if (windowName.indexOf(" ") != -1)
    errors[j++] = 'Spaces are not allowed in the target window name.<BR>Click <A HREF="javascript:parent.single6()">here</A> to provide a new name.';
  if (frameName.indexOf(" ") != -1)
    errors[j++] = 'Spaces are not allowed in the target frame name.<BR>Click <A HREF="javascript:parent.single5()">here</A> to provide a new name.';
  
  var isInvalid;
  isInvalid = invalid(0);
  if ((menuCount(0) == 0) && (!isInvalid))
    errors[j++] = 'You didn\'t enter any items in the parent menu.<BR>Click <A HREF="data.html">here</A> to add new sites to the parent menu.';
  if (isInvalid)
    errors[j++] = 'An invalid item (a blank Name field) was detected in the parent menu.<BR>Click <A HREF="data.html">here</A> to fix this problem.';

  for (var k = 1; k < menuCount(0) + 1; k++) {
      isInvalid = invalid(k);
      if ((menuCount(k) == 0) && (!isInvalid)) {
        errors[j++] = 'An empty child menu was detected.<BR>Click <A HREF="data.html">here</A> to add new sites to that child menu.';
        break;
      }
      if (isInvalid) {
        errors[j++] = 'An invalid item (a blank Name field) was detected in a child menu.<BR>Click <A HREF="data.html">here</A> to locate and fix this problem.';
        break;
      }
  }
  return getErrors(errors);
}

function invalid(x) {
  for (var k = menuCount(x) + 1; k < 50; k++) {
    if (ar[x][k].name != "") return 1;
  }
  return 0;
}

function single1() {
  live = 0;
}

function single2() {
  var counter = menuCount(0);
  if (counter > 1)
    parent.sizePnumber = counter - 2
  else
    parent.sizeP = 1;
}

function single3() {
  var str = prompt("Enter a label for the button:", "Load");
  if (str) label = str;
}

function single4() {
  var str = prompt("Enter a SRC attribute for the image:", "");
  if (str) butSRC = str;
}

function single5() {
  var str = prompt("Enter the name of the target frame:", "targetFrame");
  if (str) frameName = str;
}

function single6() {
  var str = prompt("Enter the name of the target window:", "targetWindow");
  if (str) windowName = str;
}

function single7() {
  cgi = 2;
}

function getErrors(errors) {
  if (errors.length == 0) return "";
  if (errors.length == 1) {
    var str1 = "an error";
    var str3 = "this problem";
  } else {
    var str1 = "several errors";
    var str3 = "these problems";
  }
  var str2 = "";
  for  (var i = 0; i < errors.length; i++) {
    str2 += "<LI>" + errors[i];
  }
  
  return '<FONT FACE="Arial,Helvetica,Verdana" SIZE="-1">Unfortunately, we found ' + str1 + ' in your selections:<OL>' + str2 + '</OL>Please fix ' + str3 + ' and hit the link in the left frame again.</FONT>';
}

function checkedItem2(group, start, range) {
  for (var i = 0; i < range; i++) {
    if (group[start + i].checked) return i;

  }
  return 0;
}

function checkedItem(group) {
  for (var i = 0; i < group.length; i++) {
    if (group[i].checked) return i;
  }
  return 0;
}

// -->
</SCRIPT>
</HEAD>
<SCRIPT LANGUAGE="JavaScript1.1">
<!--

var initURL = "data.html";
var search = location.search;
if (search.length > 1)
  initURL = search.substring(1, search.length);
document.write('<FRAMESET COLS="135, *" FRAMEBORDER="0"><FRAME SRC="selection.html"><FRAME SRC="' + initURL + '" NAME="main"></FRAMESET>');

// -->
</SCRIPT>
<NOSCRIPT>
<TABLE BORDER="0" CELLPADDING="5" CELLSPACING="0">
<TR  BGCOLOR="#666699"><TD ALIGN="center"><FONT FACE="Arial,Helvetica,Verdana" SIZE="-1">Not Supported</FONT></TD></TR>
<TR  BGCOLOR="#9999cc"><TD><FONT FACE="Arial,Helvetica,Verdana" SIZE="-1">
<P>If your browser supports JavaScript, make sure JavaScript is currently enabled. If you are running Navigator 2.0x, Internet Explorer 3.0x, or a browser that doesn't support JavaScript, you will need to download the latest version of Netscape Navigator or Microsoft Internet Explorer.</P>
Note that the menus created with this tool are cross-browser applications. In other words, they will work with any browser, regardless of ifs features. However, the Menu Builder itself requires a JavaScript-enabled browser as specified above.</FONT></TD></TR>
</TABLE>
</NOSCRIPT>
</HTML></HTML>